{
    "contents" : "cat(\"model{\n  #phi survival probablility\n  #gamma removal entry probability\n  #p capture probability\n  \n  #States: 1=not yet entered, 2=alive, 3=dead\n  #Observations: 1=seen, 2=not seen\n  \n  #Priors and constraints\n\n  for( s in 1:nSamples ){     \n      for( r in 1:(nRivers) ){  \n\n         phiYoy[ s,r ] ~ dunif(0,1)\n         phiAdult[ s,r ] ~ dunif(0,1)\n         gamma[ s,r ] ~ dunif(0,1)\n         pYoy [ s,r ] ~ dunif(0,1)\n         pAdult [ s,r ] ~ dunif(0,1)\n    \n      }\n    }\n\n  \n  #Define state-transition and observation matrices\n\n    #State transition for non-summer (YOY stay YOY)\n  for( s in 1:nNonSummerSamples ){     \n      for( r in 1:(nRivers) ){ \n        ps[1,nonSummerSamples[s],r,1]<-1-gamma[nonSummerSamples[s],r]\n        ps[1,nonSummerSamples[s],r,2]<-gamma[nonSummerSamples[s],r]\n        ps[1,nonSummerSamples[s],r,3]<-0\n        ps[1,nonSummerSamples[s],r,4]<-0\n        ps[2,nonSummerSamples[s],r,1]<-0\n        ps[2,nonSummerSamples[s],r,2]<-phiYoy[nonSummerSamples[s],r]\n        ps[2,nonSummerSamples[s],r,3]<-0\n        ps[2,nonSummerSamples[s],r,4]<-1-phiYoy[nonSummerSamples[s],r]\n        ps[3,nonSummerSamples[s],r,1]<-0\n        ps[3,nonSummerSamples[s],r,2]<-0\n        ps[3,nonSummerSamples[s],r,3]<-phiAdult[nonSummerSamples[s],r]\n        ps[3,nonSummerSamples[s],r,4]<-1-phiAdult[nonSummerSamples[s],r]\n        ps[4,nonSummerSamples[s],r,1]<-0\n        ps[4,nonSummerSamples[s],r,2]<-0\n        ps[4,nonSummerSamples[s],r,3]<-0\n        ps[4,nonSummerSamples[s],r,4]<-1\n      }\n  }\n  \n    #State transition for summer (YOY mature)\n  for( s in 1:nSummerSamples ){     \n      for( r in 1:(nRivers) ){ \n        ps[1,summerSamples[s],r,1]<-1-gamma[summerSamples[s],r]\n        ps[1,summerSamples[s],r,2]<-gamma[summerSamples[s],r]\n        ps[1,summerSamples[s],r,3]<-0\n        ps[1,summerSamples[s],r,4]<-0\n        ps[2,summerSamples[s],r,1]<-0\n        ps[2,summerSamples[s],r,2]<-0\n        ps[2,summerSamples[s],r,3]<-phiYoy[summerSamples[s],r]\n        ps[2,summerSamples[s],r,4]<-1-phiYoy[summerSamples[s],r]\n        ps[3,summerSamples[s],r,1]<-0\n        ps[3,summerSamples[s],r,2]<-0\n        ps[3,summerSamples[s],r,3]<-phiAdult[summerSamples[s],r]\n        ps[3,summerSamples[s],r,4]<-1-phiAdult[summerSamples[s],r]\n        ps[4,summerSamples[s],r,1]<-0\n        ps[4,summerSamples[s],r,2]<-0\n        ps[4,summerSamples[s],r,3]<-0\n        ps[4,summerSamples[s],r,4]<-1\n      }\n    }\n    \n    for(s in 1:nSamples){\n      for(r in 1:nRivers){\n      #Observation\n        po[1,s,r,1]<-0\n        po[1,s,r,2]<-1\n        po[2,s,r,1]<-pYoy[s,r]\n        po[2,s,r,2]<-1-pYoy[s,r]\n        po[3,s,r,1]<-pAdult[s,r]\n        po[3,s,r,2]<-1-pAdult[s,r]\n        po[4,s,r,1]<-0\n        po[4,s,r,2]<-1\n      }#r\n    }#s\n\n  #Likelihood\n\n#Passed as data so commented out\n#Define latent state at first occasion\n#   for(i in 1:nFirstObsRows){\n#     z[firstObsRows[i]]<-1 #All individuals start in unentered state\n#   }\n\n  for(i in 1:nEvalRows){\n    #State process\n    z[evalRows[i]]~dcat(ps[z[evalRows[i]-1],\n                        sample[evalRows[i]],\n                        river[evalRows[i]-1],])\n    #observation process\n    encDATA[evalRows[i]]~dcat(po[z[evalRows[i]],\n                                 sample[evalRows[i]],\n                                 river[evalRows[i]],])\n  }#i\n  \n  #Calculate derived population parameters\n   for( r in 1:(nRivers) ){     \n      for(s in 1:nSamples){\n        qgamma[s,r]<-1-gamma[s,r]\n      }\n    }\n  \n  for(r in 1:nRivers){\n    cprob[1,r]<-gamma[1,r]\n\n    for(s in 2:nSamples){\n      cprob[s,r]<-gamma[s,r]*prod(qgamma[1:(s-1),r])\n    }\n  }\n\n  for(r in 1:nRivers){\n    psi[r]<-sum(cprob[,r]) #Inclusion probability\n\n    for(s in 1:nSamples){\n      b[s,r]<-cprob[s,r]/psi[r]\n    }\n  }\n\n  for(r in 1:nRivers){\n    for(s in 1:nSamples){\n      for(n in 1:nSampleRows[s,r]){\n        yoyAlive[n,s,r]<-equals(z[sampleRows[n,s,r]],2)\n        adultAlive[n,s,r]<-equals(z[sampleRows[n,s,r]],3)\n      }\n      nYoy[s,r]<-sum(yoyAlive[1:nSampleRows[s,r],s,r])\n      nAdult[s,r]<-sum(adultAlive[1:nSampleRows[s,r],s,r])\n    }\n  }\n}\",file=\"bugsJS.txt\")\n\n",
    "created" : 1430407916744.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "695661295",
    "id" : "DCE09BCD",
    "lastKnownWriteTime" : 1430846815,
    "path" : "C:/Users/Evan/Desktop/Conte/westbrookJS/constructBugsStageJS.R",
    "project_path" : "constructBugsStageJS.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}